# Level14

This one doesn't have any source code. It's a program which takes in input from `stdin` and 'encrypts' it. The target is in the `token` file. We can take a look at the behaviour of the program by encrypting some strings:

```
aaaaaaaaaaaaaaaaaaaaaaaaaa =>
abcdefghijklmnopqrstuvwxyz

bbbbbbbbbbbbbbbbbbbbbbbbbb =>
bcdefghijklmnopqrstuvwxyz{

cccccccccccccccccccccccccc =>
cdefghijklmnopqrstuvwxyz{|

abcdefghijklmnopqrstuvwxyz =>
acegikmoqsuwy{}����������
```

So it looks like the output is dependent on:

* The character value.
* The character _position_.

After looking at it for a bit, it seems like the encryption works like:

```
out = in + pos(in)
```

where characters are represented as their ASCII values. We can see this from the fact that the first value is always left unchanged, and the same letter seems to 'cycle' through the alphabet as its position changes. 

We can write a script to read in a file, and subtract the position from each character and get the token! :)

```py
import sys

path = sys.argv[1]

with open(path) as f:
    contents = f.read().strip()
    print(contents)
    decrypted = ''.join(chr(ord(x) - i) for i, x in enumerate(contents))
    print(decrypted)
```

```
level14@nebula:/home/flag14$ python /tmp/exploit.py ./token 
857:g67?5ABBo:BtDA?tIvLDKL{MQPSRQWW.
<TOKEN REDACTED>
level14@nebula:/home/flag14$ su flag14
Password: 
sh-4.2$ getflag
You have successfully executed getflag on a target account
```
